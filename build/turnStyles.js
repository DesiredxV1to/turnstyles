<<<<<<< HEAD
!function(){var t,e,n=(t=function(t,e){t.exports={version:"5.6.6"}},function(n){return e||t(e={exports:{},parent:n},e.exports),e.exports});const s=function(t,e){for(let n in t){let s=t[n];if(null!=s&&s[e])return s}};const i=t=>`\n  <div id="ts_wrap">\n    <div id="turnStyles">\n      ${o}\n      ${a(t)}\n\n      ${l(t)}\n      ${r(t)}\n      ${d(t)}\n      ${u(t)}\n\n      ${m(t)}\n    </div>\n  </div>\n`,o='\n  <h3 id="ts_menu" class="ts_menu_toggle">\n    <span class="open">\u2261</span>\n    <span class="close">\u2716</span>\n    tS\n  </h3>\n\n  <div id="ts_tabs">\n    <div class="tab_opts active">Options</div>\n    <div class="tab_room">Room</div>\n    <div class="tab_ding">Notify</div>\n    <div class="tab_css">Custom Css</div>\n  </div>\n',a=t=>`\n  <div id="ts_quick">\n    ${h(t,"is_afk","Go AFK")}\n    ${h(t,"autobop","Autobop")}\n    ${h(t,"nextdj","Next DJ Spot")}\n    ${h(t,"auto_q","Auto-Queue")}\n  </div>\n`,l=t=>`\n  <div class="ts_tab tab_opts active">\n    <div>\n      <h4>General Features</h4>\n      ${h(t,"autobop","Autobop")}\n      ${h(t,"has_vol","Control Volume")}\n      ${h(t,"nextdj","Next DJ Spot")}\n    </div>\n    <div>\n      <h4>Hide Elements</h4>\n      ${h(t,"no_bub","Hide Chat Bubbles")}\n      ${h(t,"no_aud","Hide Audience")}\n      ${h(t,"no_vid","Hide Player")}\n    </div>\n    <div>\n      <h4>Visual Options</h4>\n      ${c(t,"theme")}\n      ${c(t,"style")}\n    </div>\n  </div>\n`,r=t=>`\n  <div class="ts_tab tab_room">\n    <div>\n      <h4>Automated Queue</h4>\n      ${h(t,"auto_q","Auto-Queue")} \n      <input type="text" id="ts_q_ping" class="ts_inputs"\n        value="${t.config.q_ping}" />\n      ${g("q_ping","Save Queue Ping")}\n      <small><em>Paste your bot's queue message above to take the decks automatically when you're called.</em></small>\n    </div>\n    <div>\n      <h4>AFK Reminder</h4>\n      ${h(t,"is_afk","Go AFK")}\n      <input type="text" id="ts_afk_ping" class="ts_inputs"\n        value="${t.config.afk_ping}" />\n      ${g("afk_ping","Save AFK Response")}\n      <small><em>Sends the response when you go AFK, and if you get pinged while gone.</em></small>\n    </div>\n    <div>\n      <h4>Automated Reminder</h4>\n      ${c(t,"remind",!0)} \n      <input type="text" id="ts_reminder" class="ts_inputs"\n        value="${t.config.reminder}" />\n      ${g("reminder","Save Reminder")}\n      <small><em>Send an automated message at a set interval in your room - prefixed with [tS]</em></small>\n    </div>\n    <div>\n      <h4>Debugging</h4>\n      ${h(t,"logging","Show Logs In Room Tab")}\n      ${p("reloadMusic","Fix Glitched Music Player")}\n      ${p("reload","Reload turnStyles")}\n    </div>\n  </div>\n`,d=t=>`\n  <div class="ts_tab tab_ding">\n    <div>\n      <h4>Messages In Chat</h4>\n      ${h(t,"chat_song","Last Song Stats")}\n      ${h(t,"chat_spun","Dropped DJ Stats")}\n      ${h(t,"chat_snag","User Snags")}\n      ${h(t,"chat_join","User Joins")}\n      ${h(t,"chat_left","User Leaves")}\n    </div>\n    <div>\n      <h4>Desktop Notifications</h4>\n      ${h(t,"ping_pm","On DMs")}\n      ${h(t,"ping_chat","On Mentions")}\n      ${h(t,"ping_song","On New Songs")}\n    </div>\n  </div>\n`,u=t=>`\n  <div class="ts_tab tab_css">\n    <div>\n      <h4>Custom CSS</h4>\n      <textarea id="ts_user_css" class="ts_inputs" cols="60" rows="10">${t.config.user_css}</textarea>\n      ${g("user_css","Save And Apply Styles")}\n    </div>\n  </div>\n`,h=(t,e,n)=>`\n  <label class="ts_toggle">\n    <input data-for="${e}" class="ts_option" type="checkbox"\n      ${t.config[e]?"checked":""}>\n    </input>\n    <span>\u2022</span>\n    ${n}\n  </label>\n`,c=(t,e,n)=>{return`\n  <select data-for="${e}" class="ts_option ts_inputs">\n    ${n?"":(s=e,`<option value="">No ${i=s,i[0].toUpperCase()+i.substring(1)}</option>`)}\n    ${Object.keys(t.options[e]).map(n=>`\n      <option value="${n}" ${t.config[e]==n?"selected":""}>\n        ${t.options[e][n]}\n      </option>\n    `).join("")}\n  </select>\n`;var s,i},g=(t,e)=>`\n  <button class="ts_inputs ts_optbtn" data-for="ts_${t}">${e}</button>\n`,p=(t,e)=>`\n  <button class="ts_inputs" onclick="$tS.${t}()">${e}</button>\n`,m=t=>`\n  <div class="ts_credits">\n    <small id="ts_close" class="ts_menu_toggle">\u2714\ufe0e CLOSE</small>\n    <small>v${t.config.version}</small>\n    <small>\n      <a href="https://discord.gg/jnRs4WnPjM" target="_blank">\n        Join me on the TT Discord\n      </a>\n    </small>\n  </div>\n`;const f=function(t){let e=document.createElement("style");e.classList.add("tScss"),e.type="text/css",e.innerHTML=t,$("style.tScss").remove(),document.head.append(e)},_=function(t,e,n){return`${n?`${t}/${n}`:""+t}/${e}.css`},v=function(t,e,n){let s=document.createElement("link");s.classList.add("tS-"+(n||"core")),s.type="text/css",s.rel="stylesheet",s.href=_(t,e,n),document.head.append(s)},b=function(t,e,n){let s=$("link.tS-"+n);if(!e)return!!s.length&&s.remove();s.length?s.attr("href",_(t,e,n)):v(t,e,n)};const w=(t,e,n)=>$(t).on("DOMSubtreeModified",e,n),y=function(){let t=window.turntable.playlist;t.isFiltering&&t.clearSearchBar(),$("#queue-header").removeClass("normal").addClass("edit"),t.queue.batchEditMode()},k=function(){let t=$("#playlist-header .text")[0],e=window.turntable.playlist.fileids.length,n=t.innerHTML.split("<em>")[0];t.innerHTML=`${n} <em>${e}</em>`},S=function(){if($(".profile.modal .statslink").length)return;let t=$(".profile.modal .userid"),e=t.length?t[0].innerHTML:"";24==e.length&&($(".profile.modal .section.web-links").show(),$(".profile.modal .website").append(`\n    <a class="statslink" href="https://thompsn.com/turntable/leaderboard/thing/?id=${e}" \n      target="_blank" onclick="$('.modal .close-x')[0].click()">\n      Leaderboard\n    </a>\n  `))};const C=t=>Math.log(t/100)/Math.LN2+4,j=t=>{let e=t||window.util.getSetting("volume");return 100*Math.pow(2,e-4)};const x=()=>{$(window).focus();let t={bubbles:!0,cancelable:!0,view:window},e=document.querySelectorAll(".awesome-button")[0],n=new MouseEvent("click",t);return!e.dispatchEvent(n)};const M={};(t=>{t.default={logging:!1,theme:"dark",style:"",autobop:!0,nextdj:!1,auto_q:!1,q_ping:"Hey @user - it's your turn!",has_vol:!1,no_aud:!1,no_vid:!1,no_bub:!1,ping_pm:!1,ping_song:!1,ping_chat:!1,chat_song:!1,chat_spun:!1,chat_snag:!1,chat_join:!1,chat_left:!1,is_afk:!1,afk_ping:"I'm AFK - Back in a sec!",beats:0,remind:0,reminder:"Today's theme is: Cool.",user_css:""},t.options={theme:{dark:"Dark Mode",night:"Night Mode",forest:"Forest",cosmic:"Cosmic",midnight:"Midnight"},style:{pink:"Pink",blue:"Blue",teal:"Teal",green:"Green",purple:"Purple"},remind:{0:"Don't Remind",15:"Every 15m",30:"Every 30m",60:"Every 1h",120:"Every 2h"}}})(M),(t=>{t.on=function(t,e){this.events||(this.events={}),this.events[t]||(this.events[t]=[]),this.events[t].push(e.bind(this))},t.emit=function(t,e,n){let s=this.events[t];if(s)for(let i of s)i(e,n)},t.handle=function(t){t.command&&(t.$ping=this.pinged(t.text),t.$name=this.userName(t.userid),t.$from=this.buddyName(t.senderid),t.$self=t.userid==window.turntable.user.id,this.emit(t.command,t))},t.events={}})(M),(t=>{t.view=()=>window.turntable.topViewController,t.userName=t=>{let e=window.turntable.topViewController.userMap[t];return e?e.attributes.name:"Someone"},t.buddyName=t=>{let e=window.turntable.buddyList.pmWindows[t];return!!e&&e.otherUser.attributes.name},t.pinged=t=>{let e="@"+window.turntable.user.attributes.name;return t&&t.toLowerCase().indexOf(e.toLowerCase())>-1},t.speak=t=>{let e={api:"room.speak",text:t,roomid:window.turntable.topViewController.roomId,section:window.turntable.topViewController.section};window.turntable.sendMessage(e)},t.reloadMusic=()=>{let t=window.youtube,e=window.soundcloudplayer;e.song&&(e.songTime=e.player.currentTime()/1e3,e.previewStartTime=Date.now()-1e3,e.resumeSong(e.song)),t.song&&(t.songTime=t.player[0].getCurrentTime(),t.previewStartTime=Date.now()-3e3,t.resumeSong(t.song)),$("#turnStyles").removeClass("active")},t.toggleClass=(t,e)=>{let n=$("body").hasClass(t);e&&!n&&$("body").addClass(t),n&&!e&&$("body").removeClass(t)}})(M),(t=>{t.on("attach",(function(t){for(let e of t.djids)this.cacheNewDJ(e);this.cacheTrack(t.currentSong)})),t.on("update_votes",(function(t){this.now_playing.love=t.room.metadata.upvotes,this.now_playing.hate=t.room.metadata.downvotes})),t.on("snagged",(function(){this.now_playing.snag+=1})),t.cacheNewDJ=function(t,e){let n=t.user?t.user[0].userid:t,s=this.current_djs[n],i=this.userName(n);s||(this.current_djs[n]={spun:e&&e.spun?e.spun:0,love:e&&e.love?e.love:0,hate:e&&e.hate?e.hate:0,snag:e&&e.snag?e.snag:0}),this.Log(`new dj: [${i}](${n})`)},t.clearOldDJ=function(t){let e=t.user[0].name,n=t.user[0].userid;if(!this.current_djs[n])return;let s={...this.current_djs[n]},i=`${s.love}\u2764\ufe0f${s.hate}\ud83d\udc94${s.snag}\ud83d\udc96${s.spun}\u25b6\ufe0f`;delete this.current_djs[n],this.Log(`old dj: [${e}] (${n})`),this.emit("dropped",e,i)},t.cacheTrack=function(t){let e=t&&t.room?t.room.metadata.current_song:t,n=t&&t.upvoters?t.upvoters.length:0,s=!!e&&e.djid,i={...this.now_playing},o={love:n,hate:0,snag:0,dj:s};this.last_played=i,this.now_playing=e?{...e.metadata,...o}:{},i.song&&this.current_djs[i.dj]?(this.current_djs[i.dj].spun+=1,this.current_djs[i.dj].love+=i.love,this.current_djs[i.dj].hate+=i.hate,this.current_djs[i.dj].snag+=i.snag):i.song&&this.cacheNewDJ(i.dj,i);let a=!1;i.song&&(a=`${i.love}\u2764\ufe0f${i.hate}\ud83d\udc94${i.snag}\ud83d\udc96`),this.Log("new song: "+(this.now_playing.song||"none")),this.emit("tracked",a)},t.on("add_dj",t.cacheNewDJ),t.on("rem_dj",t.clearOldDJ),t.on("nosong",t.cacheTrack),t.on("newsong",t.cacheTrack),t.last_played={},t.now_playing={},t.current_djs={}})(M),(t=>{t.init=function(){this.__base=window.tsBase||"https://ts.pixelcrisis.co/build";let t=window.localStorage.getItem("tsdb"),e=t?JSON.parse(t):{},s=n({}).version;this.config={...this.default,...e,version:s},this.config.is_afk=!1,this.emit("loaded",this.config),this.attach()},t.attach=function(){let e=window.turntable;if(!e)return this.Log("no room");if(this.lobby=$("#turntable #topBG").length,this.lobby)return this.buildWindow();let n=()=>setTimeout(t.attach.bind(this),150);if(!e.user)return n();let i=s(e,"roomId");return i&&s(i,"roomData")?(this.handler=this.handle.bind(this),window.turntable.addEventListener("message",this.handler),this.emit("attach",i),void this.Log("loaded room")):n()},t.reload=function(){clearInterval(this.heart),window.turntable.removeEventListener("message",this.handler),$('script[src*="turnStyles.js"]').remove();const t=document.createElement("script");t.src=`${this.__base}/turnStyles.js?${Math.random()}`,t.type="text/javascript",this.Log("reloading"),document.body.append(t)}})(M),(t=>{t.saveConfig=function(t){let e=t.target.dataset.for,n="checkbox"==t.target.type?t.target.checked:t.target.value;0===e.indexOf("ts_")&&(n=$("#"+e).val(),e=e.split("ts_").join("")),this.writeConfig(e,n),!["style","theme","user_css"].includes(e)&&this.lobby||this.emit("update",e,n)},t.writeConfig=function(t,e){this.config[t]=e;let n=JSON.stringify(this.config);window.localStorage.setItem("tsdb",n);let s="boolean"==typeof e;$(`*[data-for="${t}"]`).prop(s?"checked":"value",e)}})(M),(t=>{t.Log=function(t){let e=`[${(new Date).toLocaleTimeString("en-us")}]`;console.info(`${e} turnStyles :: ${t}`),this.logBook.push(`[tS] ${e} <span>${t}</span>`),this.Logged()},t.Logged=function(){this.logBook.length>50&&this.logBook.shift();let t=$("#ts_logs")[0];t&&(t.innerHTML=this.logBook.join("<br>"),t.scrollTop=t.scrollHeight)},t.logBook=[]})(M),(t=>{t.suspend=function(t,e,n){this.holding||(this.holding={}),this.holding[n]?clearTimeout(this.holding[n]):t&&t();let s=1e3*e;this.holding[n]=setTimeout((()=>{delete this.holding[n]}).bind(this),s)},t.holding={}})(M),(t=>{t.beat=function(){this.config.beats=parseInt(this.config.beats)+1,this.emit("heartbeat",this.config.beats)},t.on("attach",(function(){this.heart=setInterval(t.beat.bind(this),6e4)}))})(M),(t=>{t.buildWindow=function(){$("#ts_wrap").remove(),$(".header-bar").append(i(this)),$("#ts_logs").remove(),$(".room-info-nav").after('<div id="ts_logs"></div>'),$(".ts_menu_toggle").on("click",()=>{$("#turnStyles").toggleClass("active")}),$("#ts_tabs div").on("click",t=>{$("#ts_tabs div, .ts_tab").removeClass("active"),$("."+t.currentTarget.className).addClass("active")}),$(".ts_optbtn").on("click",t.saveConfig.bind(this)),$(".ts_option").on("change",t.saveConfig.bind(this))},t.on("attach",t.buildWindow)})(M),(t=>{t.on("loaded",(function(t){$("link.tS-core").remove(),v(this.__base,"turnStyles"),$("link.tS-themes").remove(),v(this.__base,t.theme,"themes"),$("link.tS-styles").remove(),v(this.__base,t.style,"styles"),f(t.user_css)})),t.on("update",(function(t,e){"theme"==t&&b(this.__base,e,"themes"),"style"==t&&b(this.__base,e,"styles"),"user_css"==t&&f(e)}))})(M),(t=>{t.on("attach",(function(){k(),w("#songs-wrapper","#songs",k),w("#maindiv",".overlay .profile",S),$("#upload-button").after('<div id="ts_upload"></div>'),$("#ts_upload").on("click",y),this.toggleClass("ts_hide_videos",this.config.no_vid),this.toggleClass("ts_hide_audience",this.config.no_aud),this.toggleClass("ts_hide_bubbles",this.config.no_bub),this.toggleClass("ts_has_logging",this.config.logging)})),t.on("update",(function(t,e){"no_vid"==t&&this.toggleClass("ts_hide_videos",e),"no_aud"==t&&this.toggleClass("ts_hide_audience",e),"no_bub"==t&&this.toggleClass("ts_hide_bubbles",e),"logging"==t&&this.toggleClass("ts_has_logging",e)}))})(M),(t=>{t.loadVolume=function(){let t=this.config.has_vol,e=$("body").hasClass("has-volume");this.toggleClass("has-volume",t);let n=window.turntablePlayer.realVolume;this.realVolume||(this.realVolume=n),e&&!t&&this.remVolume(),t&&!e&&this.addVolume()},t.addVolume=function(){$(".header-content").append(`\n      <div id="ts_volume">\n        <span id="ts_mute"></span>\n        <input id="ts_slider" type="range" \n          min="0" max="100" value="${j()}">\n        </input>\n        <em id="ts_muted">Muted For One Song</em>\n      </div>\n    `),$("#ts_mute").on("click",this.toggleMute.bind(this)),$("#ts_slider").on("input",this.saveVolume.bind(this)),$("#ts_slider").on("DOMMouseScroll mousewheel",this.onVolWheel.bind(this))},t.remVolume=function(){$("#ts_volume").remove(),window.turntablePlayer.realVolume=this.realVolume},t.saveVolume=function(t){let e=(t=t.target?t.target.value:t)>0?C(t):-3;window.turntablePlayer.realVolume=e>6?this.realVolume:j,window.turntablePlayer.setVolume(e),window.util.setSetting("volume",e)},t.onVolWheel=function(t){const e=j();let n=t.originalEvent.shiftKey?1:5,s=t.originalEvent.deltaY>0?e-n:e+n;return s=s<0?0:s>100?100:s,$("#ts_slider")[0].value=s,this.saveVolume(s),!1},t.toggleMute=function(){this.mute=!this.mute,$("#ts_volume").toggleClass("muted",this.mute);let t=this.mute?-3:C(j());window.turntablePlayer.setVolume(t),this.Log("turned mute "+(this.mute?"on":"off"))},t.checkMuted=function(){this.mute&&this.toggleMute()},t.on("attach",t.loadVolume),t.on("update",t.loadVolume),t.on("nosong",t.checkMuted),t.on("newsong",t.checkMuted)})(M),(t=>{t.on("update",(function(t,e){if("is_afk"!=t)return;let n=this.config.afk_ping;e&&n&&this.speak(n)})),t.on("speak",(function(t){let e=this.config.is_afk,n=this.config.afk_ping;!t.$self&&t.$ping&&e&&n?this.speak(n):t.$self&&e&&t.text!=n&&(this.writeConfig("is_afk",!1),this.postToChat("Welcome Back!","I've turned off AFK for you!","stat"))}))})(M),(t=>{t.on("tracked",(function(t){let e=this.now_playing,n=this.last_played;if(e.song&&this.config.ping_song){let n="Now Playing: "+e.song,s=t||"By: "+e.artist;this.notifyUser(n,s)}if(t&&this.config.chat_song){let e=`${n.song} by ${n.artist}`;this.postToChat(t,e,"stat")}})),t.on("dropped",(function(t,e){if(!this.config.chat_spun)return;let n=`${t} - ${e}`;this.postToChat(n," - is done spinning!","stat")}))})(M),(t=>{t.checkDecks=function(){if(this.config.nextdj)return $(".become-dj").length?(this.Log("nextdj: taking spot"),void this.view().becomeDj()):this.Log("nextdj: no spot")},t.on("add_dj",(function(t){if(!this.config.nextdj)return;if(window.turntable.user.id!=t.user[0].userid)return;let e="You've Hopped On Deck!",n="NextDJ is now disabled.";this.notifyUser(e,n),this.postToChat(e,n),this.writeConfig("nextdj",!1)})),t.on("speak",(function(t){this.config.auto_q&&this.config.q_ping==t.text&&this.view().becomeDj()})),t.on("attach",t.checkDecks),t.on("update",t.checkDecks),t.on("rem_dj",t.checkDecks)})(M),(t=>{t.notifyAuth=function(){let t=this.config;return!(!(t.ping_chat||t.ping_pm||t.ping_song)||!("Notification"in window)||"denied"===Notification.permission||"default"===Notification.permission&&(this.Log("requesting notifcation permission"),Notification.requestPermission(),1))},t.notifyUser=function(t,e,n){if(!this.notifyAuth()||document.hasFocus())return;let s=this.__base+"/images/icon128.png",i=()=>{let n=new Notification(t,{icon:s,body:e});n.onclick=()=>{window.focus(),n.close()}};return n?this.suspend(i,5,n):i()},t.postToChat=function(t,e,n){$(".chat .messages").append(`\n      <div class="message ${n}">\n        <em>\n          <span class="subject">${t}</span>\n          <span class="text">${e}</span>\n        </em>\n      </div>\n    `),this.view().updateChatScroll()},t.on("attach",t.notifyAuth),t.on("update",t.notifyAuth)})(M),(t=>{t.on("pmmed",(function(t){if(!this.config.ping_pm)return;let e="New PM "+(t.$from?"from: "+t.$from:"");this.notifyUser(e,t.text,"pm_ping")})),t.on("speak",(function(t){if(!t.$ping||!this.config.ping_chat)return;let e=`[${this.view().roomData.name}] @${t.name}`;this.notifyUser(e,t.text,"chat_ping")})),t.on("snagged",(function(t){this.config.chat_snag&&this.postToChat(t.$name,"has snagged this track!","snag")})),t.on("registered",(function(t){for(let e of t.user)this.Log(`[${e.name}](${e.userid}) joined.`),this.config.chat_join&&this.postToChat(e.name,"joined.","join")})),t.on("deregistered",(function(t){for(let e of t.user)this.Log(`[${e.name}](${e.userid}) left.`),this.config.chat_join&&this.postToChat(e.name,"left.","left")})),t.on("update_votes",(function(t){let e=t.room.metadata.votelog,n=e[e.length-1],s=this.userName(n[0]);this.Log(`[${s}] voted: ${n[1]}`)}))})(M),(t=>{t.autoBop=function(){if(this.bopping&&clearTimeout(this.bopping),!this.config.autobop)return;let t=7*Math.random()*100;this.bopping=setTimeout(x,t)},t.on("attach",t.autoBop),t.on("newsong",t.autoBop)})(M),(t=>{t.on("heartbeat",(function(t){let e=this.config.reminder;t%parseInt(this.config.remind)==0&&e&&this.speak("[tS] "+e)}))})(M),window.$tS=M,window.$tS.init()}();
=======
!function(){var t,e,n=(t=function(t,e){t.exports={version:"10.0.0"}},function(n){return e||t(e={exports:{},parent:n},e.exports),e.exports});let s=window.$tS={};var o;(o=s).default={theme:"dark",style:"",u_css:"",is_afk:!1,afkstr:"I'm AFK - Back in a sec!",people:!0,player:!0,bubble:!0,logger:!1,volume:!1,played:!1,stamps:!1,auto_b:!0,nextdj:!1,auto_q:!1,q_text:"Hey @user - it's your turn!",notify:{song:!1,ding:!1,chat:!1,text:""},alerts:{song:!1,spun:!1,snag:!1,join:!1,left:!1},hotbar:{is_afk:!0,auto_b:!0,auto_q:!0,nextdj:!0,bubble:!1,people:!1,player:!1,qtbtn1:!1,qtbtn2:!1,qtbtn3:!1},qtbtns:{qtbtn1:"",qtbtn2:"",qtbtn3:""},timing:{beat:0,post:0,text:"Today's theme is: Cool."}},o.options={theme:{dark:"Dark Mode",night:"Night Mode",cosmic:"Cosmic",midnight:"Midnight"},style:{blue:"Blue",pink:"Pink",purple:"Purple",teal:"Teal"},remind:{0:"Don't Remind",15:"Every 15m",30:"Every 30m",60:"Every 1h",120:"Every 2h"}},(t=>{t._now=()=>(new Date).toLocaleTimeString("en-us"),t._cap=t=>t[0].toUpperCase()+t.substring(1),t._link=(t,e)=>{let n=document.createElement("link");return n.id=t,n.type="text/css",n.rel="stylesheet",n.href=e,n},t._css=t=>{let e=document.createElement("style");return e.id="ts_css",e.type="text/css",e.innerHTML=t,e},t._class=(t,e)=>{let n=$("body").hasClass(t);e&&!n&&$("body").addClass(t),n&&!e&&$("body").removeClass(t)},t._click=t=>{$(window).focus();const e={bubbles:!0,cancelable:!0,view:window},n=document.querySelectorAll(t)[0],s=new MouseEvent("click",e);return!n.dispatchEvent(s)},t._clean=t=>{if(0==t.indexOf("inserted:")){let e=t.split("/");return"inserted: "+e[e.length-1]}return t},t._findKey=(t,e)=>{for(let s in t)if(null!=(n=t[s])&&n[e])return t[s];var n}})(s),(t=>{t.$_post=t=>`\n    <div class="message ${t.type||""}"><em>\n      <span class="subject">${t.head||""}</span>\n      <span class="text">${t.body||""}</span>\n    </em></div>\n  `,t.$_volume=t=>`\n    <div id="tsVolume">\n      <span id="tsMute"></span>\n      <input id="tsSlider" type="range" min="0" max="100" value="${t}" />\n      <em id="tsMuted">Muted For One Song</em>\n    </div>\n  `,t.$_userLink=t=>`\n    <a target="_blank" class="statslink"\n      onclick="$('.modal .close-x')[0].click()"\n      href="https://thompsn.com/turntable/leaderboard/thing/?id=${t}">\n      Leaderboard\n    </a>\n  `,t.$_toggle=function(t,e,n,s){return`\n    <label class="ts-toggle" ${s?`id="${s}"`:""}>\n      <input type="checkbox"\n        data-opt="${t}" \n        data-cat="${n||""}"\n        ${(n?this.config[n][t]:this.config[t])?"checked":""} />\n      <span></span> ${e}\n    </label>`},t.$_string=function(t,e,n){return`\n    <input type="text" class="ts-inputs"\n      data-opt="${t}" \n      data-cat="${n||""}" \n      value="${n?this.config[n][t]:this.config[t]}" />\n    ${this.$_button(e,t)}`},t.$_bigtxt=function(t,e,n){return`\n    <textarea class="ts-inputs" rows="10" \n      data-opt="${t}" data-cat="${n||""}">${n?this.config[n][t]:this.config[t]}</textarea>\n    ${this.$_button(e,t)}`},t.$_select=function(t,e){let n=this.options[t],s=e?this.config[e][t]:this.config[t];return`\n    <select class="ts-choice"\n      data-opt="${t}" data-cat="${e||""}">\n      <option value="">No ${this._cap(t)}</option>\n      ${Object.keys(n).map(t=>`\n        <option value="${t}" ${s==t?"selected":""}>\n          ${n[t]}\n        </option>\n      `).join("")}\n    </select>`},t.$_qt_btn=function(t){let e="qtbtn"+t,n=this.config.qtbtns[e],s=n.indexOf("||")>-1;return s?(s=(n=n.split("||")).shift(),n=n.join(" ")):s="QT"+t,this.$_button(s,!1,e,e)},t.$_button=function(t,e,n,s){return`\n    <button class="ts-button" ${n?`id="${n}"`:""}\n      ${e?`data-for="${e}"`:""}\n      ${s?`onclick="$tS.${s}()"`:""}>\n      ${t}\n    </button>`}})(s),(t=>{t.$User=()=>window.turntable.user,t.$View=()=>window.turntable.topViewController,t.$Chat=()=>window.turntable.buddyList.pmWindows,t.$Room=()=>window.turntable.topViewController.roomData,t.$Name=(e="Unknown")=>{let n=t.$View().userMap[e];return n?n.attributes.name:t.$Chat()&&t.$Chat()[e]?t.$Chat()[e].otherUser.attributes.name:e},t.$Ping=(e="")=>{let n="@"+t.$User().attributes.name;return e.toLowerCase().indexOf(n.toLowerCase())>-1},t.$Post=function(t){$(".chat .messages").append(this.$_post(t)),this.$View().updateChatScroll()},t.$Send=function(t){let e=this.$View().roomId,n=this.$View().section;window.turntable.sendMessage({text:t,api:"room.speak",roomid:e,section:n})}})(s),(t=>{t.on=function(t,...e){this.events||(this.events={}),Array.isArray(t)||(t=[t]);for(let n of t){this.events[n]||(this.events[n]=[]);for(let t of e)this.events[n].push(t.bind(this))}},t.Emit=function(t,...e){let n=this.events[t];if(n)for(let s of n)s(...e)},t.listen=function(t){t.command&&(t.$ping=this.$Ping(t.text),t.$name=this.$Name(t.userid),t.$from=this.$Name(t.senderid),t.$self=t.userid==this.$User().id,this.Emit(t.command,t))},t.watcher=function(){new(window.MutationObserver||window.WebKitMutationObserver)((function(e){for(let n of e){let e=n.target;"songs"==e.className&&t.Emit("playlist"),"messages"==e.className&&t.Emit("newchat",e),"TITLE"==e.nodeName&&e.baseURI.indexOf("profile/")>-1&&t.Emit("profile",e.baseURI.split("profile/")[1])}})).observe(document,{subtree:!0,childList:!0})},t.on("attach",t.watcher)})(s),(t=>{t.Log=function(e){console.info(`[${this._now()}] turnStyles :: ${e}`),e=this._clean(e),this.logbook=this.logbook||[],this.logbook.push(`[tS - ${this._now()}] <span>${e}</span>`),this.logbook.length>50&&this.logbook.shift(),t.Logs()&&(t.Logs().innerHTML=this.logbook.reverse().join("<br>"),t.Logs().scrollTop=t.Logs().scrollHeight)},t.Logs=()=>$("#tsLogs")[0],t.on("attach",(function(){$("#tsLogs").remove(),$(".room-info-nav").after('<div id="tsLogs"></div>')})),t.on("update",(function(t,e){this.Log(`update: [${t}] to (${e})`)})),t.on("registered",(function(t){for(let e of t.user)this.Log(`[${e.name}](${e.userid}) joined.`)})),t.on("deregistered",(function(t){for(let e of t.user)this.Log(`[${e.name}](${e.userid}) left.`)})),t.on("add_dj",(function(t){let e=t.user[0].userid;this.Log(`add dj: [${this.$Name(e)}](${e})`)})),t.on("rem_dj",(function(t){let e=t.user[0].userid;this.Log(`rem dj: [${this.$Name(e)}](${e})`)})),t.on("update_votes",(function(t){let e=t.room.metadata.votelog,n=e[e.length-1];this.Log(`[${this.$Name(n[0])}] voted: ${n[1]}`)}))})(s),(t=>{t.bindTimer=function(){this.holding={},this.heart=setInterval(t.beat.bind(this),6e4)},t.delay=function(t,e,n){if(this.holding||(this.holding={}),this.holding[n])return;let s=1e3*e;this.holding[n]=setTimeout((()=>{delete this.holding[n]}).bind(this),s),t&&t()},t.beat=function(){this.config.timing.beat=parseInt(this.config.timing.beat)+1,this.Emit("heartbeat",this.config.timing.beat)},t.on("attach",t.bindTimer)})(s),(t=>{t.Notify=function(t){if(!this.canNotify()||document.hasFocus())return;let{head:e,body:n,type:s}=t,o=this.__logo,i=()=>{let t=new Notification(e,{icon:o,body:n});t.onclick=()=>{window.focus(),t.close()}};return s?this.delay(i,5,s):i()},t.canNotify=function(){let t=this.config.notify;return!(!(t.chat||t.song||t.ding)||!("Notification"in window)||"denied"===Notification.permission||"default"===Notification.permission&&(this.Log("requesting notifications"),Notification.requestPermission(),1))},t.on(["attach","update"],t.canNotify)})(s),(t=>{t.buildCache=function(t){this.current_djs={},this.now_playing={},this.last_played={};for(let e of t.djids)this.cacheDJ(e);this.cacheSong(t.currentSong)};const e=(t={},e={})=>{let n={spun:0,love:0,hate:0,snag:0};for(let s in t)s in n&&(n[s]+=t[s]);for(let s in e)s in n&&(n[s]+=e[s]);return n},n=(t,e="")=>(t&&"love"in t&&(e+=t.love+"\u2764\ufe0f"),t&&"hate"in t&&(e+=t.hate+"\ud83d\udc94"),t&&"snag"in t&&(e+=t.snag+"\ud83d\udc96"),t&&"spun"in t&&(e+=t.spun+"\u25b6\ufe0f"),e);t.cacheDJ=function(t){let n=t.user?t.user[0].userid:t;this.current_djs[n]||(this.current_djs[n]=e())},t.resetDJ=function(t){let e=t.user[0].userid,s=n(this.current_djs[e]);delete this.current_djs[e],this.Emit("dropped",t.user[0].name,s)},t.cacheSong=function(t){let s=t&&t.room?t.room.metadata.current_song:t,o=t&&t.upvoters?t.upvoters.length:0,i=!!s&&s.djid,a={...this.now_playing},l={love:o,hate:0,snag:0,dj:i};this.now_playing=s?{...s.metadata,...l}:{},this.last_played=a;let r={...a,spun:1},h=this.current_djs[a.dj];r.song&&h&&(this.current_djs[a.dj]=e(h,r)),this.Log("new song: "+(this.now_playing.song||"none")),this.Emit("tracked",n(a))},t.cacheSnag=function(){this.now_playing.snag+=1},t.cacheVote=function(t){this.now_playing.love=t.room.metadata.upvotes,this.now_playing.hate=t.room.metadata.downvotes},t.on("attach",t.buildCache),t.on("add_dj",t.cacheDJ),t.on("rem_dj",t.resetDJ),t.on("nosong",t.cacheSong),t.on("newsong",t.cacheSong),t.on("snagged",t.cacheSnag),t.on("update_votes",t.cacheVote)})(s),(t=>{t.getConfig=function(){if(this.__base)return;this.__base=window.tsBase||"https://ts.pixelcrsis.co/build",this.__logo=this.__base+"/images/icon128.png";let t=window.localStorage.getItem("tsdb"),e=t?JSON.parse(t):{},s=n({}).version;this.config={...this.default,...e,version:s,is_afk:!1},this.update(),this.Emit("loaded",this.config)},t.saveConfig=function(t){let e=t.target,n=e.dataset;if(!n.opt&&!n.for)return;let s=n.for||n.opt,o="checkbox"==e.type?e.checked:e.value;n.for&&(o=$(`*[data-opt="${s}"]`).val()),this.setConfig(s,o,n.cat);let i=["style","theme","user_css"].includes(s);["hotbar","macros"].includes(n.cat)&&(i=!0),!i&&this.lobby||this.Emit("update",s,o,n.cat)},t.setConfig=function(t,e,n){n?this.config[n][t]=e:this.config[t]=e;let s=JSON.stringify(this.config);window.localStorage.setItem("tsdb",s);let o="boolean"==typeof e;$(`*[data-opt="${t}"][data-cat="${n||""}"]`).prop(o?"checked":"value",e)}})(s),(t=>{const e=[function(t){const e=(e,n,s,o)=>{e in t&&(s?t[n][s]=o?!t[e]:t[e]:t[n]=o?!t[e]:t[e],delete t[e])};return e("user_css","u_css"),e("autobop","auto_b"),e("logging","logger"),e("has_vol","volume"),e("q_ping","q_text"),e("afk_ping","afkstr"),e("no_aud","people",!1,!0),e("no_vid","player",!1,!0),e("no_bub","bubble",!1,!0),e("ping_pm","notify","chat"),e("ping_song","notify","song"),e("ping_chat","notify","ding"),e("hot_words","notify","text"),e("chat_song","alerts","song"),e("chat_spun","alerts","spun"),e("chat_snag","alerts","snag"),e("chat_join","alerts","join"),e("chat_left","alerts","left"),e("beats","timing","beat"),e("remind","timing","post"),e("reminder","timing","text"),t}];t.update=function(){for(let t of e)this.config=t(this.config)}})(s),(t=>{t.loadThemes=function(t){$("#ts_core, #ts_themes, #ts_styles, #ts_css").remove(),this.insert("turnStyles"),this.insert(t.theme,"themes"),this.insert(t.style,"styles"),this.inject(t.u_css),this.themed(t.theme),this._class("logger",t.logger),this._class("no_bub",!t.bubble),this._class("no_vid",!t.player),this._class("no_aud",!t.people),this._class("hb-is_afk",!t.hotbar.is_afk),this._class("hb-auto_b",!t.hotbar.auto_b),this._class("hb-auto_q",!t.hotbar.auto_q),this._class("hb-nextdj",!t.hotbar.nextdj),this._class("hb-bubble",!t.hotbar.bubble),this._class("hb-people",!t.hotbar.people),this._class("hb-player",!t.hotbar.player),this._class("hb-qtbtn1",!t.hotbar.qtbtn1),this._class("hb-qtbtn2",!t.hotbar.qtbtn2),this._class("hb-qtbtn3",!t.hotbar.qtbtn3)},t.updateThemes=function(t,e,n){"theme"==t&&this.themed(e),"theme"==t&&this.insert(e,"themes"),"style"==t&&this.insert(e,"styles"),"u_css"==t&&this.inject(e),"bubble"==t&&this._class("no_bub",!e),"player"==t&&this._class("no_vid",!e),"people"==t&&this._class("no_aud",!e),"logger"==t&&this._class("logger",e),"hotbar"==n&&("is_afk"==t&&this._class("hb-is_afk",!e),"auto_b"==t&&this._class("hb-auto_b",!e),"auto_q"==t&&this._class("hb-auto_q",!e),"nextdj"==t&&this._class("hb-nextdj",!e),"bubble"==t&&this._class("hb-bubble",!e),"people"==t&&this._class("hb-people",!e),"player"==t&&this._class("hb-player",!e),"qtbtn1"==t&&this._class("hb-qtbtn1",!e),"qtbtn2"==t&&this._class("hb-qtbtn2",!e),"qtbtn3"==t&&this._class("hb-qtbtn3",!e)),"hotbar"!=n&&"qtbtns"!=n||this.drawHotBar()},t.inject=function(t){let e=$("#ts_css");e.length?e[0].innerHTML=t:document.head.append(this._css(t)),t&&this.Log("injected: "+t)},t.insert=function(t,e){let n="ts_"+(e||"core"),s=$("#"+n),o=`${this.__base}${e?"/"+e:""}`,i=t?`${o}/${t}.css?v=${Math.random()}`:"#";s.length?s.attr("href",i):document.head.append(this._link(n,i)),"#"!=i&&this.Log("inserted: "+i.split("?v")[0])},t.themed=function(t){this._class("th-none",!t);let e=$("body").data("theme");e&&$("body").removeClass("th-"+e),t&&$("body").addClass("th-"+t),$("body").data("theme",t)},t.on("loaded",t.loadThemes),t.on("update",t.updateThemes)})(s),(t=>{const e=t=>Math.log(t/100)/Math.LN2+4,n=t=>{let e=t||window.util.getSetting("volume");return 100*Math.pow(2,e-4)};t.loadVolume=function(){let t=this.config.volume,e=$("body").hasClass("ts_vol");this._class("ts_vol",t);let n=window.turntablePlayer.realVolume;this.realVolume||(this.realVolume=n),t&&!e&&this.addVolume(),e&&!t&&this.remVolume()},t.addVolume=function(){$(".header-content").append(this.$_volume(n())),$("#tsMute").on("click",this.muteVolume.bind(this)),$("#tsSlider").on("input",this.saveVolume.bind(this)),$("#tsSlider").on("DOMMouseScroll mousewheel",this.rollVolume.bind(this))},t.remVolume=function(){$("#tsVolume").remove(),window.turntablePlayer.realVolume=this.realVolume},t.saveVolume=function(t){let s=(t=t.target?t.target.value:t)>0?e(t):-3,o=s<7?n:this.realVolume;window.turntablePlayer.realVolume=o,window.turntablePlayer.setVolume(s),window.util.setSetting("volume",s)},t.rollVolume=function(t){let e=n(),s=t.originalEvent.deltaY>0,o=t.originalEvent.shiftKey?1:5,i=s?e-o:e+o;return i=i<0?0:i>100?100:i,$("#tsSlider")[0].value=i,this.saveVolume(i),!1},t.muteVolume=function(){this.muted=!this.muted,this._class("ts_muted",this.muted);let t=this.muted?-3:e(n());window.turntablePlayer.setVolume(t),this.Log("turned mute "+(this.muted?"on":"off"))},t.checkMuted=function(){this.muted&&this.muteVolume()},t.fixMusic=()=>{let t=window.youtube,e=window.soundcloudplayer;e.song&&(e.songTime=e.player.currentTime()/1e3,e.previewStartTime=Date.now()-1e3,e.resumeSong(e.song)),t.song&&(t.songTime=t.player[0].getCurrentTime(),t.previewStartTime=Date.now()-3e3,t.resumeSong(t.song)),$("#tsPanel").removeClass("active")},t.on("attach",t.loadVolume),t.on("update",t.loadVolume),t.on("nosong",t.checkMuted),t.on("newsong",t.checkMuted)})(s),(t=>{t.linkUserStats=function(t){$(".profile.modal .statslink").length||($(".profile.modal .section.web-links").show(),$(".profile.modal .website").append(this.$_userLink(t)))},t.on("profile",t.linkUserStats)})(s),(t=>{t.qtbtn1=function(){this.qtbtns("1")},t.qtbtn2=function(){this.qtbtns("2")},t.qtbtn3=function(){this.qtbtns("3")},t.qtbtns=function(t){let e=this.config.qtbtns["qtbtn"+t],n="QT"+t;if(e)if(e.indexOf("||")>-1&&(n=(e=e.split("||")).shift().trim(),e=e.join("").trim()),(e=e.split(";;")).length>3){let t="QuickText Error!",s=`${n} message contains ${e.length}/3 messages.`;this.$Post({head:t,body:s})}else for(let s of e)this.$Send(s.trim())},t.fadeNewSong=function(t){let e=$(t).children(".message").last(),n=e.has(".avatar").length,s=e[0].innerText.includes("started playing");!n&&s&&e.addClass("stat")},t.addTimeStamp=function(t){if(!this.config.stamps)return;let e=$(".chat .messages .message:last-of-type"),n=0===e[0].innerText.indexOf(t.name);if(!e.has(".timestamp").length&&n){let t=(new Date).toLocaleTimeString("en-US").split(":").slice(0,2).join(":");e.prepend(`<div class="timestamp">${t}</div>`)}},t.on("newchat",t.fadeNewSong),t.on("speak",t.addTimeStamp)})(s),(t=>{t.watchPlaylist=function(){this.countPlaylist(),this.checkPlaylist(),this._class("played",this.config.played),$("#upload-button").after('<div id="tsUpload"></div>'),$("#tsUpload").on("click",this.orderPlaylist)},t.orderPlaylist=function(){window.playlist.isFiltering&&window.playlist.clearSearchBar(),$("#queue-header").removeClass("normal").addClass("edit"),window.playlist.queue.batchEditMode()},t.countPlaylist=function(){let t=$("#playlist-header .text")[0],e=window.playlist.fileids.length,n=t.innerHTML.split("<em>")[0];t.innerHTML=`${n} <em>${e}</em>`},t.checkPlaylist=function(){if($(".song.ts_played").removeClass("ts_played"),!this.config.played)return;let t=this.$Room().metadata.songlog;$("#queue .songs .song").each((function(){let e=$(this),n=e.find(".title").text(),s=e.find(".details").text().split(" \u2022 ")[0];for(let o of t){let{song:t,artist:i}=o.metadata;t==n&&i==s&&e.addClass("ts_played")}}))},t.togglePlayed=function(t,e){"played"==t&&this._class("played",e)},t.on("attach",t.watchPlaylist),t.on("update",t.togglePlayed),t.on("playlist",t.countPlaylist),t.on(["tracked","playlist"],t.checkPlaylist)})(s),(t=>{t.bindPanels=function(){this.drawHotBar(),this.drawWindow()},t.drawHotBar=function(){$("#tsHotBar").remove(),$(".header-bar").append(e()),$("#tsOpen").on("click",()=>$("#tsWindow").addClass("active")),$("#tsHotBar *[data-for]").on("click",this.saveConfig.bind(this)),$("#tsHotBar *[data-opt]").on("change",this.saveConfig.bind(this))},t.drawWindow=function(){$("#tsWindow").remove(),$("body").append(n()),$("#tsClose").on("click",()=>$("#tsWindow").removeClass("active")),$("#tsWindow").on("click",(function(t){t.target==this&&$("#tsWindow").removeClass("active")})),$(".ts-tab").on("click",t=>{$("#tsWindow .active").removeClass("active"),$(`*[data-tab="${t.target.dataset.tab}"]`).addClass("active")}),$("#tsWindow *[data-for]").on("click",this.saveConfig.bind(this)),$("#tsWindow *[data-opt]").on("change",this.saveConfig.bind(this))};const e=()=>`\n    <div id="tsHotBar">\n      ${t.$_button("\u2630",!1,"tsOpen")}\n      ${t.$_toggle("is_afk","AFK",!1,"hbIsAfk")}\n      ${t.$_toggle("auto_b","AutoBop",!1,"hbAutoB")}\n      ${t.$_toggle("auto_q","AutoQueue",!1,"hbAutoQ")}\n      ${t.$_toggle("nextdj","Next DJ",!1,"hbNextDJ")}\n\n      ${t.$_qt_btn("1")}\n      ${t.$_qt_btn("2")}\n      ${t.$_qt_btn("3")}\n\n      ${t.$_toggle("bubble","Bubbles",!1,"hbBubbles")}\n      ${t.$_toggle("people","People",!1,"hbPeople")}\n      ${t.$_toggle("player","Player",!1,"hbPlayer")}\n    </div>\n  `,n=()=>`\n    <div id="tsWindow">\n      <div id="tsConfig">\n        <nav>\n          <h2><span id="tsClose">\u2716</span>turnStyles</h2>\n          <div class="ts-tab active" data-tab="general">General</div>\n          <div class="ts-tab" data-tab="visual">Visual</div>\n          <div class="ts-tab" data-tab="hotbar">HotBar</div>\n          <div class="ts-tab" data-tab="alerts">Alerts</div>\n          <div class="ts-tab" data-tab="support">Help / About</div>\n        </nav>\n\n        ${s()}\n        ${o()}\n        ${i()}\n        ${a()}\n        ${l()}\n      </div>\n    </div>\n  `,s=()=>`\n    <div data-tab="general" class="ts-tabbed active">\n      <h3>Automate</h3>\n\n      <h5>${t.$_toggle("auto_b","Enable Autobop")}</h5>\n      <p>Vote "Awesome" after every new song starts, automatically!</p>\n\n      <h5>${t.$_toggle("nextdj","Take Next DJ Spot")}</h5>\n      <p>With this selected, turnStyles will attempt to automatically add you as a DJ when a spot becomes available.</p>\n\n      <h5>${t.$_toggle("auto_q","Enable AutoQueue")}</h5>\n      ${t.$_string("q_text","Save Ping")}\n      <p>Have a bot in your room that uses a queue? Copy/paste your queue ping above to automatically jump on deck when you're called!</p>\n\n      <h3>General</h3>\n\n      <h5>${t.$_toggle("is_afk","Currently AFK")}</h5>\n      ${t.$_string("afkstr","Save AFK Text")}\n      <p>When you've marked yourself as AFK, it will send the AFK Text above, and it will send it again whenever you're pinged while AFK.</p>\n\n      <h5>${t.$_toggle("volume","Override Volume")}</h5>\n      <p>Move the volume controls to the main header (out of the menu), and add Temporary Mute (until the next song).</p>\n    </div>\n  `,o=()=>`\n    <div data-tab="visual" class="ts-tabbed">\n      <h3>Theme/Style</h3>\n      ${t.$_select("theme")}\n      ${t.$_select("style")}\n\n      <h3>Visual Tweaks</h3>\n      <h5>${t.$_toggle("played","Show Recently Played")}</h5>\n      <p>Checks your playlist and highlights songs recently played in the current room.</p>\n      <h5>${t.$_toggle("stamps","Add Timestamps To Chat")}</h5>\n      <p>Adds a timestamp to the top right of room chat messages.</p>\n\n      <h3>Turntable</h3>\n      ${t.$_toggle("bubble","Show Chat Bubbles")}\n      ${t.$_toggle("people","Show Room Audience")}\n      ${t.$_toggle("player","Show Video Player")}\n\n      <h3>Custom CSS</h3>\n      ${t.$_bigtxt("u_css","Save & Apply Styles!")}\n      <p>Add your own custom CSS snippets to turntable!</p>\n    </div>\n  `,i=()=>`\n    <div data-tab="hotbar" class="ts-tabbed">\n      <h3>QuickText</h3>\n      <h5>${t.$_toggle("qtbtn1","Enable QT 1","hotbar")}</h5>\n      ${t.$_string("qtbtn1","Save QT 1","qtbtns")}\n      <p>Send your most common messages at the push of a button!</p>\n\n      <h5>${t.$_toggle("qtbtn2","Enable QT 2","hotbar")}</h5>\n      ${t.$_string("qtbtn2","Save QT 2","qtbtns")}\n      <p>Add a button label by splitting your message with <strong>||</strong>.<br />e.g. <kbd>Hello || Hello There</kbd></p>\n\n      <h5>${t.$_toggle("qtbtn3","Enable QT 3","hotbar")}</h5>\n      ${t.$_string("qtbtn3","Save QT 3","qtbtns")}\n      <p>Send multiple messages by splitting with <strong>;;</strong>.<br />e.g. <kbd>Welcome || (Hello!) ;; (Rules!) ;; (Gif!)</kbd><br /><em>(Only 3 messages may be sent per QuickText)</em></p>\n        \n      <h3>Default</h3>\n      ${t.$_toggle("is_afk","AFK in Hot Bar","hotbar")}\n      ${t.$_toggle("auto_b","Autobop in Hot Bar","hotbar")}\n      ${t.$_toggle("auto_q","AutoQueue in Hot Bar","hotbar")}\n      ${t.$_toggle("nextdj","Next DJ in Hot Bar","hotbar")}\n      ${t.$_toggle("bubble","Chat Bubble Toggle in Hot Bar","hotbar")}\n      ${t.$_toggle("people","Audience Toggle in Hot Bar","hotbar")}\n      ${t.$_toggle("player","Player Toggle in Hot Bar","hotbar")}\n    </div>\n  `,a=()=>`\n    <div data-tab="alerts" class="ts-tabbed">\n      <h3>Hot Words</h3>\n      ${t.$_string("text","Save Hot Words","notify")}\n      <p>Sends Desktop Notifications/Highlights word match in chat. Use multiple words as a comma separated list.</p>\n\n      <h3>Notify</h3>\n      ${t.$_toggle("song","Notify On New Songs","notify")}\n      ${t.$_toggle("chat","Notify On New DMs","notify")}\n      ${t.$_toggle("ding","Notify On Mentions","notify")}\n      <p>Sends Desktop Notifications.</p>\n\n      <h3>Alert</h3>\n      ${t.$_toggle("song","Last Song Stats","alerts")}\n      ${t.$_toggle("spun","Last DJ Stats","alerts")}\n      ${t.$_toggle("snag","For User Snags","alerts")}\n      ${t.$_toggle("join","On User Joins","alerts")}\n      ${t.$_toggle("left","On User Leave","alerts")}\n      <p>These alerts show up in the room chat and are only visible to you, not for everyone to see.</p>\n    </div>\n  `,l=()=>`\n    <div data-tab="support" class="ts-tabbed ts-about">\n      <h3>Debug</h3>\n      ${t.$_toggle("logger","Show Logs In Room Tab")}\n      ${t.$_button("Reload turnStyles",!1,!1,"reload")}\n      ${t.$_button("Reload Players",!1,!1,"reloadMusic")}\n\n      <h3>Support</h3>\n      <a class="ts-button" target="_blank" href="https://discord.gg/wqmAVvgSbE">\n        turnStyles Discord\n      </a>\n      <a class="ts-button" target="_blank" href="https://discord.gg/jnRs4WnPjM">\n        turntable.fm Discord\n      </a>\n\n      <h3>Sharing</h3>\n      <a class="ts-button" target="_blank" href="https://chrome.google.com/webstore/detail/turntable-tweaks/pmlkackfnbbnjfejpddpakallilkbdme">Chrome / Opera</a>\n      <a class="ts-button" target="_blank" href="https://addons.mozilla.org/en-US/firefox/addon/turnstyles-for-turntable-fm/">Firefox</a>\n      <a class="ts-button" target="_blank" href="https://ts.pixelcrisis.co">Bookmarklet</a>\n      <a class="ts-button" target="_blank" href="https://ts.pixelcrisis.co">Beta</a>\n\n      <h3>Author</h3>\n      <em>turnStyles v${t.config.version}<em><br />\n      <strong>@crisis</strong> on Discord<br />\n      <strong>@crisis</strong> on Turntable<br />\n      <a target="_blank" href="https://patreon.com/pixelcrisis">patreon.com/pixelcrisis</a><br />\n      <em>Request Themes & More on Patreon!</em>\n    </div>\n  `;t.on("attach",t.bindPanels)})(s),(t=>{t.attach=function(){this.getConfig();const e=window.turntable;if(!e)return this.Log("no room");const n=window.turntable.user;if(this.lobby=$("#turntable #topBG").length,this.lobby)return this.bindPanels();const s=()=>setTimeout(t.attach.bind(this),150);if(!n)return s();let o=this._findKey(e,"roomId");return o&&this._findKey(o,"roomData")?(this.listener=this.listen.bind(this),window.turntable.addEventListener("message",this.listener),this.Emit("attach",o),void this.Log("loaded room")):s()},t.reload=function(){clearInterval(this.heart),window.turntable.removeEventListener("message",this.listener),$('script[src*="turnStyles.js"]').remove();const t=document.createElement("script");t.src=`${this.__base}/turnStyles.js?v=${Math.random()}`,t.type="text/javascript",this.Log("reloading"),document.body.append(t)}})(s),(t=>{t.setAfk=function(t,e,n){"is_afk"!=t||n||e&&this.config.afkstr&&this.isAfk()},t.getAfk=function(t){if(!this.config.is_afk)return;let e=this.config.afkstr.split(";;").map(t=>t.trim());!t.$self&&t.$ping?this.isAfk():t.$self&&!e.includes(t.text)&&(this.setConfig("is_afk",!1),this.$Post({head:"Welcome Back!",body:"You're no longer AFK!"}))},t.isAfk=function(){if(!this.config.afkstr)return;let t=this.config.afkstr.split(";;");if(t.length>3)return this.$Post({head:"AFK Error!",body:`Contains ${t.length}/3 messages`});for(let e of t)this.$Send(e.trim())},t.on("speak",t.getAfk),t.on("update",t.setAfk)})(s),(t=>{t.autoBop=function(){if(this.bop&&clearTimeout(this.bop),!this.config.auto_b)return;const t=7*Math.random()*100;this.bop=setTimeout(()=>this._click(".awesome-button"),t)},t.autoJump=function(){if(this.config.nextdj)return $(".become-dj").length?(this.Log("nextdj: attempting jump"),void this.$View().becomeDj()):this.Log("nextdj: no spot")},t.spinning=function(t){if(!this.config.nextdj)return;if(this.$User().id!=t.user[0].userid)return;this.setConfig("nextdj",!1);const e="You've hopped on deck!",n="NextDJ is now disabled.";this.Notify({head:e,body:n}),this.$Post({head:e,body:n})},t.autoQueue=function(t){this.config.auto_q&&this.config.q_text==t.text&&this.$View().becomeDj()},t.autoRemind=function(t){if(!this.config.timing.text)return;let e=parseInt(this.config.timing.post),n=`[${this.$Room().name}] ${this.config.timing.text}`;t%e==0&&this.config.timing.text&&this.$Send(n)},t.on(["attach","newsong"],t.autoBop),t.on(["attach","update","rem_dj"],t.autoJump),t.on(["speak","pmmed"],t.autoQueue),t.on("add_dj",t.spinning),t.on("heartbeat",t.autoRemind)})(s),(t=>{t.songStats=function(t){let e=this.last_played;this.config.alerts.song&&t&&this.$Post({head:t,body:`${e.song} by ${e.artist}`,type:"stat"})},t.djStats=function(t,e){this.config.alerts.spun&&this.$Post({head:`${t} - ${e}`,body:" - is done spinning!",type:"stat"})},t.on("tracked",t.songStats),t.on("dropped",t.djStats)})(s),(t=>{t.notifyPMs=function(t){this.config.notify.chat&&this.Notify({head:"New PM "+(t.$from?"from: "+t.$from:""),body:t.text,type:"pm_ping"})},t.notifyDings=function(t){this.config.notify.ding&&t.$ping&&this.Notify({head:`[${this.view().roomData.name}] @${t.name}`,body:t.text,type:"chat_ping"}),this.notifyText(t)},t.notifySong=function(){let t=this.now_playing;this.config.notify.song&&t.song&&this.Notify({head:"Now Playing: "+t.song,body:"By: "+t.artist})},t.notifyText=function(t){let e=t.text.toLowerCase();if(this.config.notify.text.length<3)return;let n=this.config.notify.text.toLowerCase().split(",");for(let s of n)if(e.indexOf(s.trim())>-1)return $(".chat .messages .message:last-child").addClass("mention"),this.Notify({head:`Hot Word: "${s}"`,body:t.text})},t.alertSnags=function(t){this.config.alerts.snag&&this.$Post({head:t.$name,body:"has snagged this track!",type:"snag"})},t.alertJoin=function(t){if(this.config.alerts.join)for(let e of t.user)this.$Post({head:e.name,body:"joined.",type:"join"})},t.alertLeft=function(t){if(this.config.alerts.left)for(let e of t.user)this.$Post({head:e.name,body:"left.",type:"left"})},t.on("pmmed",t.notifyPMs),t.on("speak",t.notifyDings),t.on("tracked",t.notifySong),t.on("snagged",t.alertSnags),t.on("registered",t.alertJoin),t.on("deregistered",t.alertLeft)})(s),s.attach()}();
>>>>>>> dev
